---
title: "data_mining_final"
output: html_document
date: "2024-09-27"
---

```{r}
library(ggplot2)
library(readr)
library(readxl)
library(corrplot)
library(tidyr)
library(dplyr)
```



```{r}
police_2022 <- read.csv("Police_Incidents_2022_-1086747341579432639.csv")
police_2021 <- read.csv("Police_Incidents_2021.csv")
police_2023 <- read.csv("Police_Incidents_2023.csv")
```

```{r}
police_area <- bind_rows(police_2021, police_2022, police_2023)
police_area <- police_area
```


clustering/heat map
```{r}
library("factoextra")
library("cluster")

```

```{r}

numeric_columns <- sapply(police_area, is.numeric)  # Returns TRUE for numeric columns

# Print the names of numeric columns
print(names(police_area)[numeric_columns])

area_clean <- police_area |> select("X","Y","reportedTime","beginTime","UCRCode",
                                    "centergbsid","centerLong","centerLat",
                                    "centerX","centerY","OBJECTID", "precinct",
                                    "neighborhood", "offense") |> drop_na()

```

Chi-squared based on offense vs precinct
```{r}
contingency_table2 <- table(area_clean$offense, area_clean$precinct)

```

```{r}
chi_squared_result <- chisq.test(contingency_table2)

# View the result
chi_squared_result
```
anova on offense vs neighborhood
```{r}
result <- aov(area_clean$UCRCode ~ area_clean$neighborhood, data = area_clean)

# Check the results of the ANOVA
summary(result)
```


```{r}
cluster_data <- area_clean |> select("centerLong", "centerLat", "UCRCode")
```

```{r}
set.seed(2)
km.out <-  kmeans(cluster_data, 3, nstart = 5)
```

```{r}
fviz_cluster(km.out, data = cluster_data,
             palette=c("red", "blue", "darkgreen"),
             ellipse.type = "euclid",
             star.plot = T,
             repel = T,
             ggtheme = theme())
```


```{r}
library(gapminder)
library(here)
library(tidyverse)
library(ggrepel)
library(socviz)
library(mapproj)
```


```{r}
library(ggplot2)
library(usmap)

cluster_assignments <- km.out$cluster

classification_df <- data.frame(state=tolower(names(cluster_assignments)),
                                cluster=as.factor(as.numeric(cluster_assignments)))

state_plot <- plot_usmap(regions="states", data=classification_df, values="cluster") + 
  labs(title="US States",subtitle="Clusters by Arrest Rates.") + 
  scale_colour_hue() + 
  theme( panel.background = element_rect(color = "black", fill = "white"), legend.position="right") + 
  guides(fill=guide_legend(title=""))

state_plot
```


```{r}

us_states_elec <- left_join(us_states,election)
```



























